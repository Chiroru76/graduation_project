<turbo-frame id="character_modal">
  <div class="fixed inset-0 z-50 flex items-center justify-center p-4 animate-fade-in" id="character-detail-modal">
    <!-- èƒŒæ™¯ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹ï¼‰ -->
    <div class="absolute inset-0 bg-black/20 backdrop-blur-sm"
         onclick="document.getElementById('character_modal').innerHTML='';"
         aria-hidden="true"></div>

    <!-- ãƒ¢ãƒ¼ãƒ€ãƒ«æœ¬ä½“ -->
    <div class="relative w-full max-w-md max-h-[90vh] bg-white rounded-3xl shadow-2xl overflow-y-auto transform transition-all duration-300 <%= 'opacity-60' if character.dead_at.present? %>">
      <!-- é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ -->
      <button class="sticky top-4 float-right z-10 w-8 h-8 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-900 transition-all duration-200 hover:rotate-90 mr-4"
              onclick="document.getElementById('character_modal').innerHTML='';"
              aria-label="é–‰ã˜ã‚‹">
        <span class="text-xl leading-none">Ã—</span>
      </button>

      <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ï¼šãƒ¬ãƒ™ãƒ«ãƒãƒƒã‚¸ -->
      <div class="pt-4 pb-3 px-6 border-b border-gray-100">
        <div class="inline-flex items-center gap-2 px-3 py-1 bg-gray-900 text-white rounded-full text-sm font-semibold">
          <span class="text-xs opacity-70">LEVEL</span>
          <span class="text-base"><%= character.level %></span>
        </div>
      </div>

      <!-- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”»åƒã‚¨ãƒªã‚¢ -->
      <div class="px-6 py-4 bg-gradient-to-b from-gray-50 to-white">
        <div class="relative w-32 h-32 mx-auto">
          <% if appearance.present? %>
            <%= image_tag appearance.asset_path,
                          alt: character.character_kind.name,
                          class: "w-full h-full object-contain drop-shadow-lg" %>
          <% else %>
            <div class="w-full h-full flex items-center justify-center text-gray-300 text-5xl font-bold">?</div>
          <% end %>
        </div>
      </div>

      <!-- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å -->
      <div class="px-6 pb-4 border-b border-gray-100">
        <h2 class="text-xl font-bold text-gray-900 text-center tracking-tight">
          <%= character.character_kind.name %>
        </h2>
      </div>

      <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <div class="px-6 py-4 space-y-4 bg-white">
        <!-- çµŒé¨“å€¤ -->
        <div class="space-y-2">
          <div class="flex items-center justify-between text-sm">
            <span class="font-semibold text-gray-700">çµŒé¨“å€¤</span>
            <span class="font-medium text-gray-500">
              <%= character.respond_to?(:exp_progress_percentage) ? "#{character.exp_progress_percentage}%" : "0%" %>
            </span>
          </div>
          <div class="h-2 bg-gray-100 rounded-full overflow-hidden">
            <div class="h-full bg-gradient-to-r from-emerald-400 to-teal-400 rounded-full transition-all duration-700 ease-out shadow-sm"
                 style="width: <%= character.respond_to?(:exp_progress_percentage) ? character.exp_progress_percentage : 0 %>%"></div>
          </div>
        </div>

        <!-- ã—ã‚ã‚ã›åº¦ -->
        <% if character.respond_to?(:bond_hp_ratio) %>
          <div class="space-y-2">
            <div class="flex items-center justify-between text-sm">
              <span class="font-semibold text-gray-700">ã—ã‚ã‚ã›åº¦</span>
              <span class="font-medium text-gray-500"><%= character.bond_hp %></span>
            </div>
            <div class="h-2 bg-gray-100 rounded-full overflow-hidden">
              <div class="h-full bg-gradient-to-r from-pink-400 to-orange-400 rounded-full transition-all duration-700 ease-out shadow-sm"
                   style="width: <%= character.bond_hp_ratio %>%"></div>
            </div>
          </div>
        <% end %>
      </div>

      <!-- è©³ç´°æƒ…å ± -->
      <div class="px-6 py-4 bg-gray-50 border-t border-gray-100">
        <div class="space-y-2">
          <div class="flex items-center justify-between py-1.5">
            <span class="text-xs font-semibold text-gray-500 uppercase tracking-wider">ç”Ÿã¾ã‚ŒãŸæ—¥</span>
            <span class="text-sm font-medium text-gray-900">
              <%= character.created_at&.strftime("%Yå¹´%-mæœˆ%-dæ—¥") || "â€”" %>
            </span>
          </div>

          <div class="h-px bg-gray-200"></div>

          <div class="flex items-center justify-between py-1.5">
            <span class="text-xs font-semibold text-gray-500 uppercase tracking-wider">æœ€å¾Œã«æ´»å‹•ã—ãŸæ—¥</span>
            <span class="text-sm font-medium text-gray-900">
              <%= character.last_activity_at&.strftime("%Yå¹´%-mæœˆ%-dæ—¥") || "â€”" %>
            </span>
          </div>

          <% if character.dead_at.present? %>
            <div class="h-px bg-gray-200"></div>
            <div class="flex items-center justify-between py-1.5 px-3 bg-red-50 rounded-lg -mx-3">
              <span class="text-xs font-semibold text-red-600 uppercase tracking-wider">ğŸ’€ æ—…ç«‹ã£ãŸæ—¥</span>
              <span class="text-sm font-medium text-red-700">
                <%= character.dead_at&.strftime("%Yå¹´%-mæœˆ%-dæ—¥") %>
              </span>
            </div>
          <% end %>
        </div>
      </div>

      <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
      <div class="px-6 py-3 bg-white border-t border-gray-100 flex items-center justify-between">
        <span class="text-xs font-mono text-gray-400">No. <%= character.id.to_s.rjust(4, '0') %></span>
        <button class="px-6 py-2 bg-gray-900 hover:bg-gray-800 text-white text-sm font-semibold rounded-lg transition-colors duration-200"
                onclick="document.getElementById('character_modal').innerHTML='';">
          é–‰ã˜ã‚‹
        </button>
      </div>
    </div>
  </div>

  <style>
    @keyframes fade-in {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    .animate-fade-in {
      animation: fade-in 0.2s ease-out;
    }
  </style>
</turbo-frame>
